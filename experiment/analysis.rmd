---
title: "Agent Impact"
author: "David Ferreira Quaresma (david.quaresma@ccc.ufcg.edu.br)"
date: "october, 2019"
output: pdf_document
---

# Experimentos utilizando apenas runtime
#### intervalo de confiança
```{r}
source("analysis.R")

agent = filter(rbind(read.al(paste("./manual-tests/agent-thumb/", "vegeta-output", ".csv", sep=""))), status == 200, grepl('MC4', response_body))
noagent = filter(filter(rbind(read.al(paste("./manual-tests/no-agent/", "vegeta-output", ".csv", sep=""))), status == 200), latency > 10000000000)
proxy = filter(filter(rbind(read.al(paste("./manual-tests/proxy/", "vegeta-output", ".csv", sep=""))), status == 200), latency > 10000000000)

agent$latency = agent$latency / 1000000000
noagent$latency = noagent$latency / 1000000000
proxy$latency = proxy$latency / 1000000000
```
#### plot
```{r}
plot(agent$latency, ylab="latência", main="latências de 5000 requisições com agent")
plot(noagent$latency, ylab="latência", main="latências de 5000 requisições sem agent")
plot(proxy$latency, ylab="latência", main="latências de 5000 requisições com proxy")
```
#### hist
```{r}
hist(agent$latency, main="latências de 5000 requisições com agent")
hist(noagent$latency, main="latências de 5000 requisições sem agent")
hist(proxy$latency, main="latências de 5000 requisições com proxy")
```
#### summary table for latency
```{r}
print_latency_summary_table(agent, noagent, "AGENT", "NOAGENT")
print_latency_summary_table(proxy, noagent, "PROXY", "NOAGENT")
```


#### summary table for service time
```{r}
require("base64enc")

get_service_time_column <- function(df) {
  service_time = c()
  for (val in df$response_body) {
    service_time <- c(service_time, as.numeric(rawToChar(base64decode(toString(val)))))
  }
  return(service_time)
}

agent$service_time = get_service_time_column(agent)
noagent$service_time = get_service_time_column(noagent)
proxy$service_time = get_service_time_column(proxy)

agent$service_time = agent$service_time * 1000
noagent$service_time = noagent$service_time * 1000
proxy$service_time = proxy$service_time * 1000

stats(agent$service_time, "AGENT")
stats(noagent$service_time,"NOAGENT")
stats(proxy$service_time, "PROXY")
```
